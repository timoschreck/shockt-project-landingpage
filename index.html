<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>shockT project</title>
    <!-- Import Google Fonts for a graffiti and modern look -->
    <link href="https://fonts.googleapis.com/css2?family=Permanent+Marker&family=Montserrat:wght@400;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="style.css" />
</head>
<body>
    <!-- Hero Section -->
    <header class="hero">
        <div class="overlay">
            <h1 class="logo">shockT project</h1>
            <p class="tagline">Deutschrap. Pop. Schmerz. Club.</p>
            <a href="#music" class="btn primary">Hör jetzt rein</a>
        </div>
    </header>

    <!-- About Section -->
    <section id="about" class="about section">
        <h2>Über mich</h2>
        <p>
            Ich mach Musik zwischen Rausch und Realität. Zwischen Pop und Schmerz.
            Zwischen Club und Kopfkino. <strong>shockT project</strong> ist kein Act – es ist
            ein Zustand.
        </p>
    </section>

    <!-- Music Section -->
    <section id="music" class="music section">
        <h2>Meine Tracks</h2>
        <!-- Album cover displayed first. Clicking on it will reveal the songs list -->
            <div class="album-container">
                <img id="album-cover" src="album_cover.png" alt="No.1 – Von Sehnsucht, Zweifel und Kraft Album Cover" />
            </div>
            <!-- Back button for returning to the album cover view. Hidden by default and shown when songs are visible. -->
            <button id="back-button" class="btn secondary" style="display:none; margin: 1rem auto;">Zurück</button>
            <!-- Song list hidden by default. It will be shown when the album cover is clicked -->
            <div id="album-songs" class="songs">
            <div class="song">
           <h3>Fremdes Glück</h3>
                <audio controls controlsList="nodownload" oncontextmenu="return false;">
                        <source src="songs/Fremdes Glück.mp3" type="audio/mpeg" />
                    Dein Browser unterstützt das Audioelement nicht.
                </audio>
                <!-- Hidden play count counter -->
                <span class="play-count" data-key="fremdes-glueck">0</span>
            </div>
            <div class="song">
                <h3>Genau Hier</h3>
                <audio controls controlsList="nodownload" oncontextmenu="return false;">
                    <source src="songs/Genau Hier.mp3" type="audio/mpeg" />
                    Dein Browser unterstützt das Audioelement nicht.
                </audio>
                <span class="play-count" data-key="genau-hier">0</span>
            </div>
            <div class="song">
                <h3>Magie</h3>
                <audio controls controlsList="nodownload" oncontextmenu="return false;">
                    <source src="songs/Magie.mp3" type="audio/mpeg" />
                    Dein Browser unterstützt das Audioelement nicht.
                </audio>
                <span class="play-count" data-key="magie">0</span>
            </div>
            <div class="song">
                <h3>Heute wird’s geil</h3>
                <audio controls controlsList="nodownload" oncontextmenu="return false;">
                    <source src="songs/Heute_wirds_geil.mp3" type="audio/mpeg" />
                    Dein Browser unterstützt das Audioelement nicht.
                </audio>
                <span class="play-count" data-key="heute-wirds-geil">0</span>
            </div>
            <div class="song">
                <h3>Sehnsucht, Freiheit</h3>
                <audio controls controlsList="nodownload" oncontextmenu="return false;">
                    <source src="songs/Sehnsucht, Freiheit.mp3" type="audio/mpeg" />
                    Dein Browser unterstützt das Audioelement nicht.
                </audio>
                <span class="play-count" data-key="sehnsucht-freiheit">0</span>
            </div>
            <div class="song">
                <h3>Sonne im Block</h3>
                <audio controls controlsList="nodownload" oncontextmenu="return false;">
                    <source src="songs/Sonne im Block.mp3" type="audio/mpeg" />
                    Dein Browser unterstützt das Audioelement nicht.
                </audio>
                <span class="play-count" data-key="sonne-im-block">0</span>
            </div>
            <div class="song">
                <h3>Step by Step (Selbstrespekt)</h3>
                <audio controls controlsList="nodownload" oncontextmenu="return false;">
                    <source src="songs/Step by Step (Selbstrespekt).mp3" type="audio/mpeg" />
                    Dein Browser unterstützt das Audioelement nicht.
                </audio>
                <span class="play-count" data-key="step-by-step-selbstrespekt">0</span>
            </div>
            <div class="song">
                <h3>Traum bleibt</h3>
                <audio controls controlsList="nodownload" oncontextmenu="return false;">
                    <source src="songs/Traum bleibt.mp3" type="audio/mpeg" />
                    Dein Browser unterstützt das Audioelement nicht.
                </audio>
                <span class="play-count" data-key="traum-bleibt">0</span>
            </div>
            <div class="song">
                <h3>Was kommt</h3>
                <audio controls controlsList="nodownload" oncontextmenu="return false;">
                    <source src="songs/Was kommt.mp3" type="audio/mpeg" />
                    Dein Browser unterstützt das Audioelement nicht.
                </audio>
                <span class="play-count" data-key="was-kommt">0</span>
            </div>
            <div class="song">
                <h3>Zurück im Licht</h3>
                <audio controls controlsList="nodownload" oncontextmenu="return false;">
                    <source src="songs/Zurück im Licht.mp3" type="audio/mpeg" />
                    Dein Browser unterstützt das Audioelement nicht.
                </audio>
                <span class="play-count" data-key="zurueck-im-licht">0</span>
            </div>
        </div>
        <!-- Button to open the album player. Shows an overlay with controls for sequential playback -->
        <button id="play-all-btn" class="btn primary" style="margin: 1rem auto; display: block;">
            Komplettes Album anhören
        </button>
        <!-- Album player overlay. Contains controls to navigate through the album when playing all songs -->
        <div id="album-player" class="album-player" style="display: none;">
            <p class="album-player-title"><strong>Album Player</strong></p>
            <div class="player-controls">
                <button id="prev-song-btn" class="btn secondary">Vorheriger Song</button>
                <button id="stop-player-btn" class="btn secondary">Stopp</button>
                <button id="next-song-btn" class="btn secondary">Nächster Song</button>
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section id="contact" class="contact section">
        <h2>Kontakt / Booking</h2>
        <form class="contact-form">
            <input type="text" name="name" placeholder="Name" required />
            <input type="email" name="email" placeholder="E-Mail" required />
            <textarea name="message" placeholder="Nachricht" rows="4" required></textarea>
            <button type="submit" class="btn secondary">Senden</button>
        </form>
    </section>

    <!-- Legal Section: Impressum, Urheberrecht und Datenschutz -->
    <section id="legal" class="legal section">
        <h2>Impressum &amp; Datenschutz</h2>
        <h3>Impressum</h3>
        <p>
            shockT project<br />
            Timo Schreck<br />
            Villinger Straße&nbsp;20<br />
            68239 Mannheim, Deutschland<br />

            E‑Mail: <a href="mailto:contact@shockt-project.de">contact@shockt-project.de</a>
        </p>
        <p>
            Verantwortlich für den Inhalt nach §&nbsp;18&nbsp;Abs.&nbsp;2&nbsp;MStV: Timo Schreck, Anschrift wie oben.
        </p>
        <h3>Urheberrecht</h3>
        <p>
            Alle Inhalte dieser Website, insbesondere Texte, Bilder und Audiodateien, sind urheberrechtlich
            geschützt. Alle Lieder sind Eigentum von shockT project und weltweit lizenzrechtlich geschützt.
            Die Vervielfältigung, Bearbeitung, Verbreitung und jede Art der Verwertung außerhalb der Grenzen
            des Urheberrechts bedürfen der vorherigen schriftlichen Zustimmung des Urhebers. Downloads und
            Kopien dieser Seite sind nur für den privaten, nicht kommerziellen Gebrauch gestattet.
        </p>
        <h3>Datenschutzerklärung</h3>
        <p>
            Wir nehmen den Schutz Ihrer persönlichen Daten ernst. Personenbezogene Daten (z.&nbsp;B. Name, E‑Mail),
            die Sie uns im Kontaktformular mitteilen, werden nur zur Bearbeitung Ihrer Anfrage genutzt und nicht
            ohne Ihre ausdrückliche Zustimmung an Dritte weitergegeben. Beim Abspielen der Songs werden keine
            personenbezogenen Daten an uns übermittelt; die lokalen Wiedergabedaten werden lediglich in Ihrem Browser
            gespeichert (localStorage) und nicht an den Server übertragen. Weitere Analyse‑ oder Tracking‑Tools werden
            nicht eingesetzt. Sie haben jederzeit das Recht auf Auskunft, Berichtigung oder Löschung Ihrer bei uns
            gespeicherten Daten sowie das Recht auf Beschwerde bei der zuständigen Aufsichtsbehörde.
        </p>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <p>&copy; 2025 shockT project. Alle Rechte vorbehalten.</p>
        <div class="social-links">
            <a href="https://instagram.com" target="_blank">Instagram</a>
            <a href="https://spotify.com" target="_blank">Spotify</a>
            <a href="https://youtube.com" target="_blank">YouTube</a>
            <a href="https://tiktok.com" target="_blank">TikTok</a>
        </div>
        <div class="footer-links">
            <a href="#legal">Impressum &amp; Datenschutz</a>
        </div>
    </footer>

    <!-- User Info Modal for collecting mandatory user data before ratings/comments -->
    <div id="user-info-modal" class="user-modal" style="display: none;">
        <div class="user-modal-content">
            <h3>Bitte registrieren Sie sich</h3>
            <p>Um Bewertungen und Kommentare abzugeben, benötigen wir Ihren Vor- und Nachnamen sowie E-Mail oder Telefonnummer.</p>
            <input type="text" id="firstName" placeholder="Vorname" required />
            <input type="text" id="lastName" placeholder="Name" required />
            <input type="email" id="userEmail" placeholder="E-Mail" />
            <input type="tel" id="userPhone" placeholder="Telefonnummer" />
            <p id="user-info-error" class="error-message" style="display:none;">Bitte füllen Sie alle Pflichtfelder aus.</p>
            <button id="user-info-submit" class="btn primary" style="margin-top: 1rem;">Informationen absenden</button>
        </div>
    </div>

    <!-- Script to toggle visibility of songs when album cover is clicked
         and to track play counts for each song. The play counts are stored
         in localStorage and updated on each play event. The counters are hidden
         from the user but increment behind the scenes. -->
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            var cover = document.getElementById('album-cover');
            var songsContainer = document.getElementById('album-songs');
            var backButton = document.getElementById('back-button');
            // Hide songs container and back button initially
            if (songsContainer) {
                songsContainer.style.display = 'none';
            }
            if (backButton) {
                backButton.style.display = 'none';
            }
            // Show songs when cover is clicked; keep the cover visible and show the back button
            if (cover && songsContainer && backButton) {
                cover.addEventListener('click', function () {
                    songsContainer.style.display = 'grid';
                    backButton.style.display = 'inline-block';
                    // keep cover visible
                });
                // Hide songs and back button when back button is clicked
                backButton.addEventListener('click', function () {
                    songsContainer.style.display = 'none';
                    backButton.style.display = 'none';
                    // cover remains visible
                });
            }
                // Initialize play counters for each song
                var audioElements = document.querySelectorAll('#album-songs audio');

                // Track the currently playing audio so that only one song plays at a time.
                var currentAudio = null;

            // ----- User registration modal and gating logic -----
            // References to modal elements and helper function to show the modal
            var userModal = document.getElementById('user-info-modal');
            var userSubmitBtn = document.getElementById('user-info-submit');
            var userInfoError = document.getElementById('user-info-error');
            function showUserModal() {
                if (userModal) {
                    userModal.style.display = 'flex';
                }
            }
            // Hide rating and comment forms until the user has provided their contact information.
            // If the visitor has not yet submitted the required user info (name and contact), hide
            // all rating and comment input fields to prevent interactions.  After registration,
            // these elements will be made visible again by the submission handler below.
            if (!localStorage.getItem('userInfoSubmitted')) {
                document.querySelectorAll('.rating, .comment-section').forEach(function (el) {
                    el.style.display = 'none';
                });
            }
            // Handle submission of the user registration form
            if (userSubmitBtn) {
                userSubmitBtn.addEventListener('click', function () {
                    var firstNameEl = document.getElementById('firstName');
                    var lastNameEl = document.getElementById('lastName');
                    var emailEl = document.getElementById('userEmail');
                    var phoneEl = document.getElementById('userPhone');
                    var firstName = firstNameEl ? firstNameEl.value.trim() : '';
                    var lastName = lastNameEl ? lastNameEl.value.trim() : '';
                    var emailVal = emailEl ? emailEl.value.trim() : '';
                    var phoneVal = phoneEl ? phoneEl.value.trim() : '';
                    // Validate required fields: first/last name and at least one contact (email or phone)
                    if (!firstName || !lastName || (!emailVal && !phoneVal)) {
                        if (userInfoError) {
                            userInfoError.textContent = 'Bitte geben Sie Vorname, Name und E‑Mail oder Telefonnummer an.';
                            userInfoError.style.display = 'block';
                        }
                        return;
                    }
                    // Persist user data
                    var info = { firstName: firstName, lastName: lastName, email: emailVal, phone: phoneVal };
                    try {
                        localStorage.setItem('userInfo', JSON.stringify(info));
                    } catch (err) {
                        // ignore storage errors
                    }
                    localStorage.setItem('userInfoSubmitted', 'true');
                    // Hide the modal
                    if (userModal) {
                        userModal.style.display = 'none';
                    }
                    // Remove any existing rating/comment data stored in localStorage
                    Object.keys(localStorage).forEach(function (k) {
                        if (k.startsWith('ratings_') || k.startsWith('ratingCount_') || k.startsWith('lastRating_') || k.startsWith('comments_')) {
                            localStorage.removeItem(k);
                        }
                    });
                    // Show rating and comment input sections now that the user has registered.
                    // Any previously collected ratings/comments have been cleared above, so new
                    // submissions will be collected for moderation.  By making these elements
                    // visible here, the user can leave new feedback after providing their details.
                    document.querySelectorAll('.rating, .comment-section').forEach(function (el) {
                        el.style.display = '';
                    });
                    // Reset any error message
                    if (userInfoError) {
                        userInfoError.style.display = 'none';
                    }
                });
            }

                audioElements.forEach(function (audio) {
                var parent = audio.parentElement;
                var counter = parent.querySelector('.play-count');
                if (!counter) return;
                var key = counter.dataset.key;
                // Load stored count from localStorage if available
                if (key) {
                    var stored = localStorage.getItem('playCount_' + key);
                    if (stored !== null) {
                        counter.textContent = stored;
                    }
                }
                    // Increment counter on each play event and ensure only one audio plays at a time
                    audio.addEventListener('play', function () {
                        // If another audio is currently playing, pause it
                        if (currentAudio && currentAudio !== audio) {
                            currentAudio.pause();
                        }
                        // Update the current audio reference
                        currentAudio = audio;

                        var count = parseInt(counter.textContent) || 0;
                        count += 1;
                        counter.textContent = count;
                        if (key) {
                            localStorage.setItem('playCount_' + key, count);
                        }
                    });
            });

            // Dynamically add rating stars and comment sections for each song
            var songItems = document.querySelectorAll('#album-songs .song');
            songItems.forEach(function (song) {
                var playCounter = song.querySelector('.play-count');
                if (!playCounter) return;
                var key = playCounter.dataset.key;
                // Rating container
                var ratingContainer = document.createElement('div');
                ratingContainer.className = 'rating';
                ratingContainer.dataset.key = key;
                // Create five stars
                for (var i = 1; i <= 5; i++) {
                    var star = document.createElement('span');
                    star.className = 'star';
                    star.dataset.value = i;
                    star.innerHTML = '\u2605'; // Unicode filled star
                    ratingContainer.appendChild(star);
                }
                /*
                 * We no longer display rating counts publicly.  Ratings are stored
                 * internally in localStorage under the key "ratings_<songKey>".  When a
                 * user rates a song, the value (1–5) is pushed to an array in
                 * localStorage.  This ensures that ratings are collected but not shown
                 * until they are approved by the site owner.  The rating container is
                 * appended directly to the song without a visible count.
                 */
                song.appendChild(ratingContainer);
                // Comment section
                var commentSection = document.createElement('div');
                commentSection.className = 'comment-section';
                var textarea = document.createElement('textarea');
                textarea.setAttribute('maxlength', '250');
                textarea.setAttribute('placeholder', 'Kommentar (max. 250 Zeichen)');
                var submitBtn = document.createElement('button');
                submitBtn.className = 'btn secondary comment-submit';
                submitBtn.textContent = 'Kommentar senden';
                var msg = document.createElement('p');
                msg.className = 'comment-message';
                msg.style.display = 'none';
                msg.textContent = 'Danke für deinen Kommentar! Er wird nach Überprüfung veröffentlicht.';
                commentSection.appendChild(textarea);
                commentSection.appendChild(submitBtn);
                commentSection.appendChild(msg);
                song.appendChild(commentSection);
            });
            // Rating click handler with user info check
            document.addEventListener('click', function (e) {
                if (e.target.classList.contains('star')) {
                    // If user info has not been submitted, prompt for it and abort rating
                    if (!localStorage.getItem('userInfoSubmitted')) {
                        if (typeof showUserModal === 'function') {
                            showUserModal();
                        }
                        return;
                    }
                    var star = e.target;
                    var ratingContainer = star.parentElement;
                    var value = parseInt(star.dataset.value);
                    var stars = ratingContainer.querySelectorAll('.star');
                    stars.forEach(function (s, index) {
                        if (index < value) {
                            s.classList.add('selected');
                        } else {
                            s.classList.remove('selected');
                        }
                    });
                    var key = ratingContainer.dataset.key;
                    if (key) {
                        // Store each individual rating value in an array to be
                        // moderated later.  Comments and ratings are not publicly
                        // displayed until approved by the site owner.
                        var ratingsKey = 'ratings_' + key;
                        var ratings = [];
                        try {
                            ratings = JSON.parse(localStorage.getItem(ratingsKey) || '[]');
                        } catch (err) {
                            ratings = [];
                        }
                        ratings.push(value);
                        localStorage.setItem(ratingsKey, JSON.stringify(ratings));
                        // Also update a total count to track how many times a song has been rated.
                        var countKey = 'ratingCount_' + key;
                        var currentCount = parseInt(localStorage.getItem(countKey) || '0');
                        currentCount += 1;
                        localStorage.setItem(countKey, currentCount);
                        // Optionally store the last rating value; not publicly used.
                        localStorage.setItem('lastRating_' + key, value);
                    }
                }
            });
            // Comment submission handler with user info check
            document.addEventListener('click', function (e) {
                if (e.target.classList.contains('comment-submit')) {
                    e.preventDefault();
                    // If user info has not been submitted, show modal and abort
                    if (!localStorage.getItem('userInfoSubmitted')) {
                        if (typeof showUserModal === 'function') {
                            showUserModal();
                        }
                        return;
                    }
                    var button = e.target;
                    var commentSection = button.parentElement;
                    var textarea = commentSection.querySelector('textarea');
                    var message = commentSection.querySelector('.comment-message');
                    var comment = textarea.value.trim();
                    if (comment.length === 0) {
                        return;
                    }
                    // Identify song key via closest .song element
                    var songDiv = button.closest('.song');
                    var playCounter = songDiv ? songDiv.querySelector('.play-count') : null;
                    if (playCounter) {
                        var key = playCounter.dataset.key;
                        var commentsKey = 'comments_' + key;
                        var existing = [];
                        try {
                            existing = JSON.parse(localStorage.getItem(commentsKey) || '[]');
                        } catch (err) {
                            existing = [];
                        }
                        existing.push(comment);
                        localStorage.setItem(commentsKey, JSON.stringify(existing));
                    }
                    // Clear textarea and show thank you message
                    textarea.value = '';
                    if (message) {
                        message.style.display = 'block';
                        setTimeout(function () {
                            message.style.display = 'none';
                        }, 4000);
                    }
                }
            });

            // Album player functionality: sequential playback of all songs
            var playAllBtn = document.getElementById('play-all-btn');
            var albumPlayer = document.getElementById('album-player');
            var prevBtn = document.getElementById('prev-song-btn');
            var nextBtn = document.getElementById('next-song-btn');
            var stopBtn = document.getElementById('stop-player-btn');
            // Create an array from NodeList of audio elements for sequential control
            var albumAudios = Array.prototype.slice.call(audioElements);
            var albumPlaying = false;
            var playIndex = 0;
            /**
             * Play a song at the given index and update currentAudio. Stops any
             * currently playing track. If index is outside bounds, nothing happens.
             */
            function playSong(index) {
                if (index < 0 || index >= albumAudios.length) {
                    return;
                }
                // Pause and reset current audio if another song is playing
                if (currentAudio && !currentAudio.paused) {
                    currentAudio.pause();
                    currentAudio.currentTime = 0;
                }
                currentAudio = albumAudios[index];
                playIndex = index;
                albumPlaying = true;
                currentAudio.play();
            }
            /** Play the next song in the album (wrap to first if at end) */
            function playNext() {
                var nextIndex = playIndex + 1;
                if (nextIndex >= albumAudios.length) {
                    nextIndex = 0;
                }
                playSong(nextIndex);
            }
            /** Play the previous song in the album (wrap to last if at beginning) */
            function playPrev() {
                var prevIndex = playIndex - 1;
                if (prevIndex < 0) {
                    prevIndex = albumAudios.length - 1;
                }
                playSong(prevIndex);
            }
            /** Stop all playback and reset state */
            function stopAll() {
                albumPlaying = false;
                if (currentAudio) {
                    currentAudio.pause();
                    currentAudio.currentTime = 0;
                }
            }
            // When the play-all button is clicked, show the album player and start with the first track
            if (playAllBtn && albumPlayer) {
                playAllBtn.addEventListener('click', function () {
                    // Show overlay and make sure songs list and back button are visible
                    albumPlayer.style.display = 'block';
                    if (songsContainer) {
                        songsContainer.style.display = 'grid';
                    }
                    if (backButton) {
                        backButton.style.display = 'inline-block';
                    }
                    playSong(0);
                });
            }
            // Hook up control buttons
            if (nextBtn) {
                nextBtn.addEventListener('click', function () {
                    playNext();
                });
            }
            if (prevBtn) {
                prevBtn.addEventListener('click', function () {
                    playPrev();
                });
            }
            if (stopBtn) {
                stopBtn.addEventListener('click', function () {
                    stopAll();
                });
            }
            // Automatically play next track when the current track ends, if album is playing
            albumAudios.forEach(function (aud) {
                aud.addEventListener('ended', function () {
                    if (albumPlaying) {
                        playNext();
                    }
                });
            });
        });
    </script>
</body>
</html>
